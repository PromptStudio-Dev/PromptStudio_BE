[Full Context]
{fullContext}

[Selected Text]
{selectedText}

[Previous Direction]
{prevDirection}

[Previous Result]
{prevResult}

[Current Direction]
{direction}

Previous info is for reference only. Prioritize current direction.

Output the upgraded text that will directly replace the selected text. Preserve exact start and end boundaries.