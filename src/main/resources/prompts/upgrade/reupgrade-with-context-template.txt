[Full Context]
{fullContext}

[Selected Text]
{selectedText}

[Previous Direction]
{prevDirection}

[Previous Result]
{prevResult}

[Current Direction]
{direction}

[Reference Prompts]
{ragContext}

Use reference prompts for style/structure inspiration onlyâ€”do NOT copy directly.
Previous direction/result is for reference. Prioritize the current direction if conflicts arise.

Upgrade the selected text according to the CURRENT improvement direction. Output only the upgraded text.