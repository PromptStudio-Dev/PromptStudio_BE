[Full Context]
{fullContext}

[Selected Text]
{selectedText}

[Previous Direction]
{prevDirection}

[Previous Result]
{prevResult}

[Current Direction]
{direction}

[Reference Prompts]
{ragContext}

Reference prompts are for style inspiration only. Previous info is for reference. Prioritize current direction.

Output the upgraded text that will directly replace the selected text. Preserve exact start and end boundaries.